"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[65392],{39038:(e,r,n)=>{n.d(r,{Ay:()=>l,RM:()=>i});var t=n(86070),s=n(15658);const i=[];function o(e){const{Url:r}={...(0,s.R)(),...e.components};return r||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Url",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r,{href:"/end-user-flows",children:" Flux utilisateur final : flux d'authentification, flux de compte et flux d'organisation "}),"\n",(0,t.jsx)(r,{href:"/connectors",children:" Configurer les connecteurs "}),"\n",(0,t.jsx)(r,{href:"/authorization/api-resources/protect-your-api",children:" Prot\xe9ger votre API "})]})}function l(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},90084:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"quick-starts/framework/wordpress/README","title":"Ajoutez l\u2019authentification \xe0 votre application WordPress","description":"Ce tutoriel vous montrera comment int\xe9grer Logto \xe0 votre site web Wordpress.","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/quick-starts/framework/wordpress/README.mdx","sourceDirName":"quick-starts/framework/wordpress","slug":"/quick-starts/wordpress","permalink":"/fr/quick-starts/wordpress","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/fr/docusaurus-plugin-content-docs/current/quick-starts/framework/wordpress/README.mdx","tags":[],"version":"current","frontMatter":{"slug":"/quick-starts/wordpress","sidebar_label":"WordPress","sidebar_custom_props":{"description":"WordPress est un syst\xe8me de gestion de contenu libre et open-source."}},"sidebar":"quickStartSidebar","previous":{"title":"Webflow","permalink":"/fr/quick-starts/webflow"},"next":{"title":"Machine-to-machine","permalink":"/fr/quick-starts/m2m"}}');var s=n(86070),i=n(15658),o=n(39038);const l={slug:"/quick-starts/wordpress",sidebar_label:"WordPress",sidebar_custom_props:{description:"WordPress est un syst\xe8me de gestion de contenu libre et open-source."}},d="Ajoutez l\u2019authentification \xe0 votre application WordPress",c={},a=[{value:"Pr\xe9requis",id:"pr\xe9requis",level:2},{value:"Int\xe9gration",id:"int\xe9gration",level:2},{value:"Installer le plugin",id:"installer-le-plugin",level:3},{value:"Configurer l&#39;URI de redirection",id:"configurer-luri-de-redirection",level:3},{value:"Configurer le plugin",id:"configurer-le-plugin",level:3},{value:"Point de contr\xf4le : Testez votre application",id:"point-de-contr\xf4le--testez-votre-application",level:3},{value:"Mappage des r\xf4les",id:"mappage-des-r\xf4les",level:2},{value:"Pr\xe9requis",id:"pr\xe9requis-1",level:3},{value:"Impl\xe9menter le mappage des r\xf4les",id:"impl\xe9menter-le-mappage-des-r\xf4les",level:3},{value:"\xc9tape 1 : acc\xe9der au fichier functions.php de votre th\xe8me",id:"\xe9tape-1--acc\xe9der-au-fichier-functionsphp-de-votre-th\xe8me",level:3},{value:"\xc9tape 2 : \xe9crire la fonction de mappage des r\xf4les",id:"\xe9tape-2--\xe9crire-la-fonction-de-mappage-des-r\xf4les",level:3},{value:"\xc9tape 3 : comprendre le code et le personnaliser",id:"\xe9tape-3--comprendre-le-code-et-le-personnaliser",level:3},{value:"\xc9tape 4 : tester votre configuration",id:"\xe9tape-4--tester-votre-configuration",level:3},{value:"Lectures compl\xe9mentaires",id:"lectures-compl\xe9mentaires",level:2},...o.RM];function u(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"ajoutez-lauthentification-\xe0-votre-application-wordpress",children:"Ajoutez l\u2019authentification \xe0 votre application WordPress"})}),"\n",(0,s.jsxs)(r.p,{children:["Ce tutoriel vous montrera comment int\xe9grer Logto \xe0 votre site web ",(0,s.jsx)(r.a,{href:"https://wordpress.org",children:"Wordpress"}),"."]}),"\n",(0,s.jsx)(r.h2,{id:"pr\xe9requis",children:"Pr\xe9requis"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Un compte ",(0,s.jsx)(r.a,{href:"https://cloud.logto.io",children:"Logto Cloud"})," ou un ",(0,s.jsx)(r.a,{href:"/introduction/set-up-logto-oss",children:"Logto auto-h\xe9berg\xe9"}),"."]}),"\n",(0,s.jsx)(r.li,{children:"Une application traditionnelle Logto cr\xe9\xe9e."}),"\n",(0,s.jsxs)(r.li,{children:["Un projet WordPress : suivez le guide d'installation officiel de ",(0,s.jsx)(r.a,{href:"https://wordpress.org/support/article/how-to-install-wordpress/",children:"Wordpress"})," pour configurer votre site web Wordpress avant de continuer."]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"int\xe9gration",children:"Int\xe9gration"}),"\n",(0,s.jsx)(r.h3,{id:"installer-le-plugin",children:"Installer le plugin"}),"\n",(0,s.jsxs)(r.p,{children:["Nous utiliserons le plugin ",(0,s.jsx)(r.a,{href:"https://wordpress.org/plugins/generic-openid-connect/",children:"OpenID Connect Generic"})," pour int\xe9grer Logto via le protocole OIDC dans votre site web Wordpress."]}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsx)(r.li,{children:"Connectez-vous \xe0 votre site WordPress."}),"\n",(0,s.jsx)(r.li,{children:'Allez dans "Plugins" et cliquez sur "Ajouter nouveau".'}),"\n",(0,s.jsx)(r.li,{children:'Recherchez "OpenID Connect Generic" et installez le plugin par daggerhart.'}),"\n",(0,s.jsx)(r.li,{children:"Activez le plugin."}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"configurer-luri-de-redirection",children:"Configurer l'URI de redirection"}),"\n",(0,s.jsx)(r.p,{children:'Tout d\'abord, configurons l\'URI de redirection. Vous pouvez le trouver dans les param\xe8tres du plugin, faites d\xe9filer jusqu\'\xe0 la section "Notes" et copiez la valeur "Redirect URI".'}),"\n",(0,s.jsx)(r.p,{children:'Passez \xe0 la page des d\xe9tails de l\'application de Logto Console. Ajoutez un URI de redirection et cliquez sur "Enregistrer les modifications".'}),"\n",(0,s.jsx)(r.h3,{id:"configurer-le-plugin",children:"Configurer le plugin"}),"\n",(0,s.jsx)(r.p,{children:"R\xe9f\xe9rez-vous au tableau suivant pour les d\xe9tails de configuration n\xe9cessaires :"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Champ du plugin"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Client ID"}),(0,s.jsx)(r.td,{children:"L'ID de l'application de votre application Logto"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Client Secret"}),(0,s.jsx)(r.td,{children:"Le secret de l'application de votre application Logto"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"OpenID Scope"}),(0,s.jsxs)(r.td,{children:["Entrez ",(0,s.jsx)(r.code,{children:"email profile openid offline_access"})]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Login Endpoint URL"}),(0,s.jsx)(r.td,{children:"L'URL du point de terminaison d'autorisation de votre application Logto, qui est https://[tenant-id].logto.app/oidc/auth, vous pouvez cliquer sur \"afficher les d\xe9tails du point de terminaison\" dans la page de l'application Logto pour obtenir l'URL."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Userinfo Endpoint URL"}),(0,s.jsx)(r.td,{children:"L'URL du point de terminaison des informations utilisateur de votre application Logto, qui est https://[tenant-id].logto.app/oidc/me."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Token Validation Endpoint URL"}),(0,s.jsx)(r.td,{children:"L'URL du point de terminaison de validation des jetons de votre application Logto, qui est https://[tenant-id].logto.app/oidc/token."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"End Session Endpoint URL"}),(0,s.jsx)(r.td,{children:"L'URL du point de terminaison de fin de session de votre application Logto, qui est https://[tenant-id].logto.app/oidc/session/end."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Identity Key"}),(0,s.jsx)(r.td,{children:"La cl\xe9 unique dans le jeton d\u2019identifiant qui contient l'identit\xe9 de l'utilisateur, elle peut \xeatre email ou sub, selon votre configuration."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Nickname Key"}),(0,s.jsx)(r.td,{children:"La cl\xe9 dans le jeton d\u2019identifiant qui contient le surnom de l'utilisateur, vous pouvez la d\xe9finir sur sub et la modifier plus tard."})]})]})]}),"\n",(0,s.jsx)(r.h3,{id:"point-de-contr\xf4le--testez-votre-application",children:"Point de contr\xf4le : Testez votre application"}),"\n",(0,s.jsx)(r.p,{children:"Maintenant, vous pouvez tester votre application :"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsx)(r.li,{children:"D\xe9connectez-vous de votre site WordPress."}),"\n",(0,s.jsx)(r.li,{children:'Visitez la page de connexion WordPress et cliquez sur le bouton "Se connecter avec Logto".'}),"\n",(0,s.jsx)(r.li,{children:"Vous serez redirig\xe9 vers la page de connexion Logto."}),"\n",(0,s.jsx)(r.li,{children:"Connectez-vous avec votre compte Logto."}),"\n",(0,s.jsx)(r.li,{children:"Vous serez redirig\xe9 vers le site WordPress et connect\xe9 automatiquement."}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"mappage-des-r\xf4les",children:"Mappage des r\xf4les"}),"\n",(0,s.jsx)(r.p,{children:"WordPress dispose d'un syst\xe8me de gestion des r\xf4les utilisateur int\xe9gr\xe9 qui d\xe9finit les actions (capacit\xe9s) qu'un utilisateur peut effectuer sur un site. Les r\xf4les utilisateur par d\xe9faut incluent Administrateur, \xc9diteur, Auteur, Contributeur et Abonn\xe9, chacun avec son propre ensemble de capacit\xe9s."}),"\n",(0,s.jsx)(r.p,{children:"Logto utilise le Contr\xf4le d\u2019acc\xe8s bas\xe9 sur les r\xf4les (RBAC) comme mod\xe8le d'Autorisation, utilisant les \"port\xe9es\" comme la plus petite unit\xe9 de Permission. Ces port\xe9es d\xe9finissent les actions sp\xe9cifiques qu'un utilisateur authentifi\xe9 est autoris\xe9 \xe0 effectuer au sein d'une application. Cependant, WordPress fonctionne sur un principe diff\xe9rent pour g\xe9rer les Permissions utilisateur, en s'appuyant sur des \"r\xf4les\" pr\xe9d\xe9finis qui regroupent diverses capacit\xe9s ensemble."}),"\n",(0,s.jsx)(r.p,{children:"\xc9tant donn\xe9 cette diff\xe9rence fondamentale, nous sugg\xe9rons de cr\xe9er des r\xf4les sp\xe9ciaux au sein de Logto qui correspondent aux r\xf4les d\xe9finis dans WordPress. Ces r\xf4les peuvent ne pas avoir de port\xe9es, ils sont uniquement utilis\xe9s comme r\xe9f\xe9rence pour mapper les utilisateurs aux r\xf4les WordPress."}),"\n",(0,s.jsx)(r.h3,{id:"pr\xe9requis-1",children:"Pr\xe9requis"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Configurez des r\xf4les dans Logto qui correspondent aux r\xf4les dans WordPress. Par exemple, si vous avez un r\xf4le '\xe9diteur' dans WordPress, cr\xe9ez un r\xf4le 'group",":editors","' dans Logto."]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"impl\xe9menter-le-mappage-des-r\xf4les",children:"Impl\xe9menter le mappage des r\xf4les"}),"\n",(0,s.jsxs)(r.p,{children:["Pour impl\xe9menter le mappage des r\xf4les, nous ajouterons du code personnalis\xe9 au fichier ",(0,s.jsx)(r.code,{children:"functions.php"})," du th\xe8me WordPress. Cela implique d'utiliser le hook d'action ",(0,s.jsx)(r.code,{children:"wp_login"}),", qui se d\xe9clenche lorsqu'un utilisateur se connecte. Voici un guide \xe9tape par \xe9tape sur la fa\xe7on de configurer cela :"]}),"\n",(0,s.jsx)(r.h3,{id:"\xe9tape-1--acc\xe9der-au-fichier-functionsphp-de-votre-th\xe8me",children:"\xc9tape 1 : acc\xe9der au fichier functions.php de votre th\xe8me"}),"\n",(0,s.jsxs)(r.p,{children:["Ouvrez le fichier ",(0,s.jsx)(r.code,{children:"functions.php"})," de votre th\xe8me. Vous pouvez acc\xe9der \xe0 ce fichier via le panneau d'administration WordPress en naviguant vers Apparence > \xc9diteur de th\xe8me et en s\xe9lectionnant ",(0,s.jsx)(r.code,{children:"functions.php"})," dans la liste des fichiers \xe0 droite. Ou dans le code source, naviguez vers le r\xe9pertoire de votre th\xe8me WordPress et localisez le fichier ",(0,s.jsx)(r.code,{children:"functions.php"}),". Ce fichier vous permet d'ajouter des fonctions PHP personnalis\xe9es qui \xe9tendent les fonctionnalit\xe9s de votre site WordPress."]}),"\n",(0,s.jsx)(r.h3,{id:"\xe9tape-2--\xe9crire-la-fonction-de-mappage-des-r\xf4les",children:"\xc9tape 2 : \xe9crire la fonction de mappage des r\xf4les"}),"\n",(0,s.jsxs)(r.p,{children:["Voici un exemple simple d'une fonction que vous pourriez ajouter \xe0 functions.php. Cette fonction sera d\xe9clench\xe9e lors de la connexion de l'utilisateur et assignera des r\xf4les en fonction de la revendication ",(0,s.jsx)(r.code,{children:"roles"})," de l'utilisateur r\xe9cup\xe9r\xe9e depuis Logto."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-php",children:"function logto_handler($user_login, $user = null) {\n\tif (!$user) {\n\t\t$user = get_user_by('login', $user_login);\n\t}\n\n\t$oidc_claims = get_user_meta($user->ID, 'openid-connect-generic-last-user-claim', true);\n\n\tif (in_array('group:editors', $oidc_claims['roles'])) {\n\t\t$user->set_role('editor');\n\t} else {\n\t\t$user->set_role('subscriber');\n\t}\n}\n\nadd_action('wp_login', 'logto_handler', 10, 2);\n"})}),"\n",(0,s.jsx)(r.h3,{id:"\xe9tape-3--comprendre-le-code-et-le-personnaliser",children:"\xc9tape 3 : comprendre le code et le personnaliser"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Fonction ",(0,s.jsx)(r.code,{children:"logto_handler"})," : Cette fonction prend deux param\xe8tres : ",(0,s.jsx)(r.code,{children:"$user_login"})," (nom d'utilisateur) et ",(0,s.jsx)(r.code,{children:"$user"})," (objet utilisateur). Elle r\xe9cup\xe8re les r\xf4les depuis Logto qui sont stock\xe9s dans les m\xe9tadonn\xe9es utilisateur sous ",(0,s.jsx)(r.code,{children:"openid-connect-generic-last-user-claim"}),", mappe ce r\xf4le \xe0 un r\xf4le WordPress correspondant et l'assigne \xe0 l'utilisateur."]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"add_action"})," : Cette ligne connecte la fonction ",(0,s.jsx)(r.code,{children:"logto_handler"})," \xe0 l'action ",(0,s.jsx)(r.code,{children:"wp_login"}),", qui est d\xe9clench\xe9e apr\xe8s la connexion d'un utilisateur. Le ",(0,s.jsx)(r.code,{children:"10"})," est la priorit\xe9 (par d\xe9faut), et ",(0,s.jsx)(r.code,{children:"2"})," indique le nombre d'arguments que la fonction accepte."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["L'exemple ci-dessus assigne le r\xf4le '\xe9diteur' aux utilisateurs authentifi\xe9s via Logto avec le nom de r\xf4le ",(0,s.jsx)(r.code,{children:"group:editors"}),". Cependant, dans un sc\xe9nario r\xe9el, vous devrez probablement impl\xe9menter plus de types de mappages de r\xf4les."]}),"\n",(0,s.jsxs)(r.p,{children:["Vous pouvez trouver la liste des r\xf4les WordPress et leurs capacit\xe9s ",(0,s.jsx)(r.a,{href:"https://wordpress.org/support/article/roles-and-capabilities/",children:"ici"}),"."]}),"\n",(0,s.jsx)(r.h3,{id:"\xe9tape-4--tester-votre-configuration",children:"\xc9tape 4 : tester votre configuration"}),"\n",(0,s.jsxs)(r.p,{children:["Maintenant, testons la fonction de mappage des r\xf4les en nous connectant avec un utilisateur qui a le r\xf4le ",(0,s.jsx)(r.code,{children:"group:editors"})," dans Logto. Apr\xe8s vous \xeatre connect\xe9, v\xe9rifiez le r\xf4le de l'utilisateur dans WordPress pour vous assurer que le mappage fonctionne correctement."]}),"\n",(0,s.jsx)(r.h2,{id:"lectures-compl\xe9mentaires",children:"Lectures compl\xe9mentaires"}),"\n",(0,s.jsx)(o.Ay,{})]})}function p(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},15658:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>l});var t=n(30758);const s={},i=t.createContext(s);function o(e){const r=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:r},e.children)}}}]);