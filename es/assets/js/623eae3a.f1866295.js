"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[89109],{31223:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>t,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"developers/custom-token-claims/README","title":"Reclamos personalizados de tokens","description":"Introducci\xf3n","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/developers/custom-token-claims/README.mdx","sourceDirName":"developers/custom-token-claims","slug":"/developers/custom-token-claims/","permalink":"/es/developers/custom-token-claims/","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/es/docusaurus-plugin-content-docs/current/developers/custom-token-claims/README.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Desarrollador","permalink":"/es/developers/"},"next":{"title":"Casos de uso comunes","permalink":"/es/developers/custom-token-claims/common-use-cases"}}');var a=n(86070),r=n(15658);const i={sidebar_position:2},c="Reclamos personalizados de tokens",t={},d=[{value:"Introducci\xf3n",id:"introducci\xf3n",level:2},{value:"\xbfC\xf3mo funcionan los reclamos personalizados de tokens?",id:"c\xf3mo-funcionan-los-reclamos-personalizados-de-tokens",level:2}];function l(e){const o={a:"a",code:"code",div:"div",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.header,{children:(0,a.jsx)(o.h1,{id:"reclamos-personalizados-de-tokens",children:"Reclamos personalizados de tokens"})}),"\n",(0,a.jsx)(o.h2,{id:"introducci\xf3n",children:"Introducci\xf3n"}),"\n",(0,a.jsx)(o.p,{children:"Los tokens de acceso juegan un papel cr\xedtico en el proceso de autenticaci\xf3n y autorizaci\xf3n, llevando la informaci\xf3n de identidad del sujeto y permisos, y se pasan entre el servidor de Logto (que act\xfaa como servidor de autenticaci\xf3n o proveedor de identidad, IdP), tu servidor de servicio web (proveedor de recursos) y aplicaciones cliente (clientes)."}),"\n",(0,a.jsx)(o.p,{children:"Los reclamos de tokens son los pares clave-valor que proporcionan informaci\xf3n sobre una entidad o el propio token. Los reclamos pueden incluir informaci\xf3n del usuario, tiempo de expiraci\xf3n del token, permisos y otros metadatos que son relevantes para el proceso de autenticaci\xf3n (link to auth.wiki) y autorizaci\xf3n (link to auth.wiki)."}),"\n",(0,a.jsx)(o.p,{children:"Hay dos tipos de tokens de acceso en Logto:"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"JSON Web Token:"})," ",(0,a.jsx)(o.a,{href:"https://datatracker.ietf.org/doc/html/rfc7519",children:"JSON Web Token (JWT)"})," es un formato popular que codifica reclamos de una manera que es segura y legible por los clientes. Los reclamos comunes como ",(0,a.jsx)(o.code,{children:"sub"}),", ",(0,a.jsx)(o.code,{children:"iss"}),", ",(0,a.jsx)(o.code,{children:"aud"}),", etc., se utilizan en l\xednea con el protocolo OAuth 2.0 (Consulta ",(0,a.jsx)(o.a,{href:"https://datatracker.ietf.org/doc/html/rfc7519#section-4",children:"este enlace"})," para m\xe1s detalles). Los tokens JWT permiten a los consumidores acceder directamente a los reclamos sin pasos de validaci\xf3n adicionales. En Logto, los tokens de acceso se emiten en formato JWT por defecto cuando un cliente inicia solicitudes de autorizaci\xf3n de recursos o organizaciones espec\xedficas."]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Token opaco (Opaque token):"})," Un token opaco no es aut\xf3nomo y siempre requiere un paso de validaci\xf3n adicional a trav\xe9s del endpoint de introspecci\xf3n de tokens. A pesar de su formato no transparente, los tokens opacos pueden ayudar a obtener reclamos y transmitirse de manera segura entre las partes. Los reclamos de tokens se almacenan de manera segura en el servidor de Logto y son accesibles por las aplicaciones cliente a trav\xe9s del endpoint de introspecci\xf3n de tokens. Los tokens de acceso se emiten en formato opaco cuando no se incluye un recurso o una organizaci\xf3n espec\xedfica en la solicitud de autorizaci\xf3n. Estos tokens se utilizan principalmente para acceder al endpoint ",(0,a.jsx)(o.code,{children:"userinfo"})," de OIDC y otros prop\xf3sitos generales."]}),"\n"]}),"\n",(0,a.jsx)(o.p,{children:"En muchos casos, los reclamos est\xe1ndar no son suficientes para satisfacer las necesidades espec\xedficas de tus aplicaciones, ya sea que est\xe9s utilizando JWT o tokens opacos. Para abordar esto, Logto proporciona la flexibilidad de agregar reclamos personalizados dentro de los tokens de acceso. Con esta funci\xf3n, puedes incluir informaci\xf3n adicional para tu l\xf3gica de negocio, todo transmitido de manera segura en los tokens y recuperable a trav\xe9s de la introspecci\xf3n en el caso de los tokens opacos."}),"\n",(0,a.jsx)(o.h2,{id:"c\xf3mo-funcionan-los-reclamos-personalizados-de-tokens",children:"\xbfC\xf3mo funcionan los reclamos personalizados de tokens?"}),"\n",(0,a.jsxs)(o.p,{children:["Logto te permite insertar reclamos personalizados en el ",(0,a.jsx)(o.code,{children:"token de acceso"})," a trav\xe9s de una funci\xf3n de callback ",(0,a.jsx)(o.code,{children:"getCustomJwtClaims"}),". Puedes proporcionar tu implementaci\xf3n de la funci\xf3n ",(0,a.jsx)(o.code,{children:"getCustomJwtClaims"})," para devolver un objeto de reclamos personalizados. El valor devuelto se fusionar\xe1 con la carga \xfatil original del token y se firmar\xe1 para generar el token de acceso final."]}),"\n",(0,a.jsx)(o.mermaid,{value:"sequenceDiagram\n  participant U as Usuario o agente de usuario\n  participant IdP as Logto (proveedor de identidad)\n  participant SP as Proveedor de Servicios\n\n  autonumber\n  U ->> IdP: Solicitud de autenticaci\xf3n (con credenciales)\n  activate IdP\n  IdP--\x3e>IdP: Validar credenciales y<br/>generar carga \xfatil del token de acceso en bruto\n  rect var(--mermaid-rect-fill)\n  note over IdP: Reclamos personalizados de tokens\n  IdP->>IdP: Ejecutar script de reclamos personalizados de tokens (`getCustomJwtClaims`) y<br/>obtener reclamos adicionales de tokens\n  end\n  IdP--\x3e>IdP: Fusionar carga \xfatil del token de acceso en bruto y reclamos adicionales de tokens\n  IdP--\x3e>IdP: Firmar y encriptar carga \xfatil para obtener token de acceso\n  deactivate IdP\n  IdP--\x3e>U: Emitir token de acceso en formato JWT\n  par Obtener servicio a trav\xe9s de API\n  U->>SP: solicitud de servicio (con token de acceso JWT)\n  SP--\x3e>U: respuesta de servicio\n  end"}),"\n",(0,a.jsx)(o.div,{children:(0,a.jsx)(o.p,{children:"Los reclamos de tokens integrados de Logto NO pueden ser sobrescritos o modificados. Los reclamos personalizados se agregar\xe1n al token como reclamos adicionales. Si alg\xfan reclamo personalizado entra en conflicto con los reclamos integrados, esos reclamos personalizados ser\xe1n ignorados."})})]})}function u(e={}){const{wrapper:o}={...(0,r.R)(),...e.components};return o?(0,a.jsx)(o,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},15658:(e,o,n)=>{n.d(o,{R:()=>i,x:()=>c});var s=n(30758);const a={},r=s.createContext(a);function i(e){const o=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function c(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(r.Provider,{value:o},e.children)}}}]);