"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[47885],{62693:(i,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>d,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"docs/recipes/organizations/just-in-time-provisioning","title":"Just-in-time provisioning","description":"In Logto, just-in-time (JIT) provisioning is a process used to assign organization memberships and roles to users on-the-fly as they sign in to the system for the first time. Instead of pre-provisioning accounts for users in advance, JIT provisioning configures the necessary user accounts dynamically when a user authenticates.","source":"@site/docs/docs/recipes/organizations/just-in-time-provisioning.mdx","sourceDirName":"docs/recipes/organizations","slug":"/docs/recipes/organizations/just-in-time-provisioning","permalink":"/docs/recipes/organizations/just-in-time-provisioning","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/docs/docs/recipes/organizations/just-in-time-provisioning.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Implement organization invitation","permalink":"/docs/recipes/organizations/organization-invitations"},"next":{"title":"\u2601\ufe0f Enterprise SSO (SAML & OIDC)","permalink":"/docs/recipes/single-sign-on/"}}');var o=n(86070),t=n(15658),r=n(10763);const a={},d="Just-in-time provisioning",l={},c=[{value:"How it works",id:"how-it-works",level:2},{value:"Benefits of JIT provisioning",id:"benefits-of-jit-provisioning",level:3},{value:"Differences between JIT and directory sync",id:"differences-between-jit-and-directory-sync",level:3},{value:"Just-in-time provisioning in Logto",id:"just-in-time-provisioning-in-logto",level:2},{value:"Enterprise SSO provisioning",id:"enterprise-sso-provisioning",level:3},{value:"Email domain provisioning",id:"email-domain-provisioning",level:3},{value:"Email sign-in experience when email domain provisioning is enabled",id:"email-sign-in-experience-when-email-domain-provisioning-is-enabled",level:4},{value:"Social sign-in experience when email domain provisioning is enabled",id:"social-sign-in-experience-when-email-domain-provisioning-is-enabled",level:4},{value:"Handling the potential conflict between JIT provisioning methods",id:"handling-the-potential-conflict-between-jit-provisioning-methods",level:3},{value:"Default organization roles",id:"default-organization-roles",level:2}];function h(i){const e={admonition:"admonition",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...i.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"just-in-time-provisioning",children:"Just-in-time provisioning"})}),"\n",(0,o.jsx)(r.A,{cloud:!0,oss:{major:1,minor:18}}),"\n",(0,o.jsx)(e.p,{children:"In Logto, just-in-time (JIT) provisioning is a process used to assign organization memberships and roles to users on-the-fly as they sign in to the system for the first time. Instead of pre-provisioning accounts for users in advance, JIT provisioning configures the necessary user accounts dynamically when a user authenticates."}),"\n",(0,o.jsx)(e.h2,{id:"how-it-works",children:"How it works"}),"\n",(0,o.jsx)(e.p,{children:"Here\u2019s a high-level overview of the JIT provisioning process:"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"User authentication"}),": The user attempts to sign in to an application or service, and the identity provider (Logto) authenticates the user."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Account sign-in or creation"}),": Depending on the user\u2019s status, Logto either signs in the user, creates a new account, or add a new identity to an existing account."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Provisioning"}),": If the user or their identity is new, Logto triggers the provisioning process."]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"Here's a detailed flowchart of JIT provisioning:"}),"\n",(0,o.jsx)(e.mermaid,{value:"stateDiagram-v2\n    direction LR\n\n    classDef provision font-weight: bold, stroke-width: 2px;\n    class sso_provision, email_provision provision\n\n    state has_account <<choice>>\n    authentication: User<br/>authentication\n    sign_in: Sign in\n    create_account: Create account\n    state is_sso_1 <<choice>>\n    state is_sso_2 <<choice>>\n    sso_provision: Provision by<br/>enterprise SSO\n    email_provision: Provision by<br/>email domain\n\n    [*] --\x3e authentication\n    authentication --\x3e has_account: User exists?\n    has_account --\x3e sign_in: Yes\n    has_account --\x3e create_account: No\n    sign_in --\x3e is_sso_1: Is SSO<br/>and first time?\n    is_sso_1 --\x3e [*]: No\n    is_sso_1 --\x3e sso_provision: Yes\n    create_account --\x3e is_sso_2: Is SSO?\n    is_sso_2 --\x3e sso_provision: Yes\n    sso_provision --\x3e [*]\n    is_sso_2 --\x3e email_provision: No\n    email_provision --\x3e [*]"}),"\n",(0,o.jsx)(e.p,{children:"JIT provisioning is a useful feature for B2B and multi-tenancy products. It makes onboarding tenant members smooth and requires no administrative involvement."}),"\n",(0,o.jsx)(e.p,{children:"For example, if you\u2019ve onboarded a business and want its employees to securely sign into your product and join the organization with the correct role access, there are several ways to achieve this. Let\u2019s explore the possible solutions Logto provides and how JIT can help."}),"\n",(0,o.jsxs)(e.table,{children:[(0,o.jsx)(e.thead,{children:(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.th,{children:"Scenario"}),(0,o.jsx)(e.th,{children:"User types"}),(0,o.jsx)(e.th,{children:"Automated?"}),(0,o.jsx)(e.th,{children:"Behavior"})]})}),(0,o.jsxs)(e.tbody,{children:[(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:"Admin invite"}),(0,o.jsx)(e.td,{children:"New and existing"}),(0,o.jsx)(e.td,{}),(0,o.jsx)(e.td,{children:"Users can receive an email invitation to join the organization."})]}),(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:"Management API user creation or import"}),(0,o.jsx)(e.td,{children:"New and existing"}),(0,o.jsx)(e.td,{}),(0,o.jsx)(e.td,{children:"Users can use a pre-created user account to join the organization."})]}),(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:"SSO just-in-time provisioning"}),(0,o.jsx)(e.td,{children:"New and existing"}),(0,o.jsx)(e.td,{children:"\u2705"}),(0,o.jsx)(e.td,{children:"Users who signs in with SSO for the first time can join the organization."})]}),(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:"Email domain just-in-time provisioning"}),(0,o.jsx)(e.td,{children:"New"}),(0,o.jsx)(e.td,{children:"\u2705"}),(0,o.jsx)(e.td,{children:"Users with specific verified domains who signs in for the first time can join the organization."})]}),(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:"Directory sync"}),(0,o.jsx)(e.td,{children:"New and existing"}),(0,o.jsx)(e.td,{children:"\u2705"}),(0,o.jsx)(e.td,{children:"Use the IdP\u2019s directory sync functionality to pre-provision users in the app in advance."})]})]})]}),"\n",(0,o.jsxs)(e.p,{children:["Currently, Logto supports ",(0,o.jsx)(e.strong,{children:"SSO just-in-time provisioning"})," and ",(0,o.jsx)(e.strong,{children:"email domain just-in-time provisioning"}),"."]}),"\n",(0,o.jsx)(e.h3,{id:"benefits-of-jit-provisioning",children:"Benefits of JIT provisioning"}),"\n",(0,o.jsx)(e.p,{children:"JIT provisioning offers several benefits:"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Efficiency"}),": Reduces the administrative overhead of manually creating and managing user accounts."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Scalability"}),": Automatically handles account creation for large numbers of users without prior setup."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Real-time"}),": Ensures users can access resources as soon as they authenticate, without delays."]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"We have implemented the JIT features at their most scalable and secure level to simplify and speed up the provisioning process for you. However, since provisioning systems can be complex and tailored to your clients\u2019 specific needs, it is essential to combine Logto\u2019s pre-built JIT features, your careful system design, and the Logto Management API. This integrated approach will help you build a robust and efficient provisioning system."}),"\n",(0,o.jsx)(e.h3,{id:"differences-between-jit-and-directory-sync",children:"Differences between JIT and directory sync"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"JIT provisioning"})," is triggered by user-initiated actions, while ",(0,o.jsx)(e.strong,{children:"Directory sync"})," can be both user-initiated and system-initiated (scheduled or real-time)."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"JIT provisioning"})," does not enforce the membership or role assignment, while ",(0,o.jsx)(e.strong,{children:"Directory sync"})," can enforce them."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"JIT provisioning"})," is more suitable for onboarding new users regardless of the user\u2019s identity source, while ",(0,o.jsx)(e.strong,{children:"Directory sync"})," is more suitable for managed user accounts."]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"In short, JIT provisioning is a more flexible and user-friendly approach to onboarding users, as it can give users the freedom to join or leave organizations and let you handle the existing users at your discretion."}),"\n",(0,o.jsx)(e.admonition,{type:"note",children:(0,o.jsx)(e.p,{children:"If you need the directory sync feature, please contact Logto team."})}),"\n",(0,o.jsx)(e.h2,{id:"just-in-time-provisioning-in-logto",children:"Just-in-time provisioning in Logto"}),"\n",(0,o.jsx)(e.admonition,{type:"info",children:(0,o.jsx)(e.p,{children:"Just-in-time (JIT) provisioning only triggers for user-initiated actions and does not affect interactions with the Logto Management API."})}),"\n",(0,o.jsx)(e.h3,{id:"enterprise-sso-provisioning",children:"Enterprise SSO provisioning"}),"\n",(0,o.jsx)(e.p,{children:"If you have Enterprise SSO set up in Logto, you can select your organization enterprise SSO to enable just-in-time provisioning."}),"\n",(0,o.jsx)(e.p,{children:"When one of the following conditions is met:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"New users sign in through enterprise SSO;"}),"\n",(0,o.jsx)(e.li,{children:"Existing users sign in through enterprise SSO for the first time."}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"They will automatically join the organization and get default organization roles."}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"Enterprise SSO provisioning",src:n(26377).A+"",width:"2496",height:"1184"})}),"\n",(0,o.jsx)(e.h3,{id:"email-domain-provisioning",children:"Email domain provisioning"}),"\n",(0,o.jsx)(e.p,{children:"If your client doesn\u2019t have a dedicated enterprise SSO, you can still use email domains for just-in-time provisioning."}),"\n",(0,o.jsx)(e.p,{children:"When a user signs up, if their verified email address match the configured JIT email domains at the organization level, they will be provisioned to the appropriate organizations with the corresponding roles."}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"Email domain provisioning",src:n(55066).A+"",width:"2496",height:"1072"})}),"\n",(0,o.jsx)(e.p,{children:"The address matching can recognize the verified email address from all non-enterprise SSO identity sources, including:"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"Email sign-up authentication"}),"\n",(0,o.jsx)(e.li,{children:"Social sign-up authentication"}),"\n"]}),"\n",(0,o.jsxs)(e.admonition,{type:"note",children:[(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Why doesn\u2019t email domain provisioning apply to the existing user sign-in process?"})}),(0,o.jsx)(e.p,{children:"Existing user sign-in requires further control to determine if they can be provisioned to a specific organization or granted a role. This process is dynamic and depends on specific use cases and business needs, such as sign-in frequency and organization-level policies."}),(0,o.jsx)(e.p,{children:"For example, if you enable email domain provisioning for an existing user and later want to onboard another group of users with a different role, should the previously onboarded user be assigned the new role you set up? This creates a complex scenario for \u201cjust-in-time updates\u201d. The exact behavior often depends on how the application and IdP integration are configured. We give this control to you, allowing you to design your provisioning system freely and handle the most frequent scenarios for new account creation and organization onboarding."})]}),"\n",(0,o.jsx)(e.h4,{id:"email-sign-in-experience-when-email-domain-provisioning-is-enabled",children:"Email sign-in experience when email domain provisioning is enabled"}),"\n",(0,o.jsxs)(e.table,{children:[(0,o.jsx)(e.thead,{children:(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.th,{children:"User status"}),(0,o.jsx)(e.th,{children:"Description"})]})}),(0,o.jsxs)(e.tbody,{children:[(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:"User does not exist and signs up with email"}),(0,o.jsx)(e.td,{children:"User is created and automatically joins the corresponding organization with appropriate roles."})]}),(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:"User exists with the same verified email address as provisioned email domains"}),(0,o.jsx)(e.td,{children:"Normal email sign-in experience."})]})]})]}),"\n",(0,o.jsx)(e.h4,{id:"social-sign-in-experience-when-email-domain-provisioning-is-enabled",children:"Social sign-in experience when email domain provisioning is enabled"}),"\n",(0,o.jsxs)(e.table,{children:[(0,o.jsx)(e.thead,{children:(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.th,{children:"User status"}),(0,o.jsx)(e.th,{children:"Description"})]})}),(0,o.jsxs)(e.tbody,{children:[(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:"User does not exist, signs up with social account using a verified email"}),(0,o.jsx)(e.td,{children:"User is created and automatically joins the corresponding organization with appropriate roles."})]}),(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:"User does not exist, signs up with social account using an unverified email or no email"}),(0,o.jsx)(e.td,{children:"Normal social sign-up experience."})]}),(0,o.jsxs)(e.tr,{children:[(0,o.jsx)(e.td,{children:"User exists with the same verified email address as provisioned email domains, signs in through a new social identity"}),(0,o.jsx)(e.td,{children:"Normal social sign-in experience."})]})]})]}),"\n",(0,o.jsx)(e.h3,{id:"handling-the-potential-conflict-between-jit-provisioning-methods",children:"Handling the potential conflict between JIT provisioning methods"}),"\n",(0,o.jsx)(e.p,{children:"If you initially set up email domain provisioning and later configure an enterprise SSO with the same email domain, here's what happens:"}),"\n",(0,o.jsx)(e.p,{children:"When a user enters their email address, they will be redirected to the SSO identity provider, bypassing the email authentication. This means the email domain provisioning won\u2019t be triggered."}),"\n",(0,o.jsx)(e.p,{children:"To address this, we will show a warning message when configuration. Ensure you handle this case by selecting the correct SSO connector to enable enterprise SSO provisioning, and do not rely on email domain provisioning."}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"Conflict warning",src:n(48120).A+"",width:"2496",height:"1264"})}),"\n",(0,o.jsx)(e.h2,{id:"default-organization-roles",children:"Default organization roles"}),"\n",(0,o.jsx)(e.p,{children:"When provisioning users in an organization, you can set their default organization roles. The role list comes from the organization template, and you can choose a role or leave it empty."})]})}function p(i={}){const{wrapper:e}={...(0,t.R)(),...i.components};return e?(0,o.jsx)(e,{...i,children:(0,o.jsx)(h,{...i})}):h(i)}},10763:(i,e,n)=>{n.d(e,{A:()=>r});const s="availability_kRMk";var o=n(86070);const t=i=>"comingSoon"===i?"coming soon-blue":"boolean"==typeof i?i?"\u2713 available-4EA254":"not applicable-78767F":`since v${i.major}.${i.minor}-4EA254`,r=i=>{let{cloud:e,oss:n}=i;return(0,o.jsxs)("div",{className:s,children:[(0,o.jsx)("img",{alt:"Cloud availability",src:`https://img.shields.io/badge/Cloud-${t(e)}`}),(0,o.jsx)("img",{alt:"OSS availability",src:`https://img.shields.io/badge/OSS-${t(n)}`})]})}},48120:(i,e,n)=>{n.d(e,{A:()=>s});const s=n.p+"assets/images/jit-conflict-20c8c47ff22e7c515772821ffeea1c7d.webp"},55066:(i,e,n)=>{n.d(e,{A:()=>s});const s=n.p+"assets/images/jit-email-95f7b7cc852ed195e3e970376e758b73.webp"},26377:(i,e,n)=>{n.d(e,{A:()=>s});const s=n.p+"assets/images/jit-sso-5538460b969a9895cd94f89f4235126d.webp"},15658:(i,e,n)=>{n.d(e,{R:()=>r,x:()=>a});var s=n(30758);const o={},t=s.createContext(o);function r(i){const e=s.useContext(t);return s.useMemo((function(){return"function"==typeof i?i(e):{...e,...i}}),[e,i])}function a(i){let e;return e=i.disableParentContext?"function"==typeof i.components?i.components(o):i.components||o:r(i.components),s.createElement(t.Provider,{value:e},i.children)}}}]);