<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs/recipes/custom-jwt/README" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">🎫 Custom token claims | Logto docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.logto.io/docs/recipes/custom-jwt/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="🎫 Custom token claims | Logto docs"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.logto.io/docs/recipes/custom-jwt/"><link data-rh="true" rel="alternate" href="https://docs.logto.io/docs/recipes/custom-jwt/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.logto.io/docs/recipes/custom-jwt/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://DE7QZWOVO6-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Logto docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Logto docs Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Logto docs" href="/opensearch.xml">

<script>var shouldTrack="logto.io"===window.location.hostname||window.location.hostname.endsWith("logto.io");shouldTrack||console.warn("Not tracking because the hostname is not logto.io")</script>
<script src="https://akasha.logto.io/placebo/sabaean.js" defer="defer" data-api="https://akasha.logto.io/placebo/eagan" data-domain="logto.io"></script>
<script>shouldTrack&&(window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)})</script>
<script async crossorigin="anonymous" src="https://www.googletagmanager.com/gtag/js?id=AW-11124811245"></script>
<script>if(shouldTrack){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","AW-11124811245")}</script>
<script>shouldTrack&&function(t,e,c,n,r,a,s){t[c]=t[c]||function(){(t[c].q=t[c].q||[]).push(arguments)},(a=e.createElement(n)).async=1,a.src="https://www.clarity.ms/tag/o9cb961ir0",(s=e.getElementsByTagName(n)[0]).parentNode.insertBefore(a,s)}(window,document,"clarity","script")</script>
<meta name="google-site-verification" content="3EYzsnarDwG6zL2dlHvyC8ySVcV6Q3RGlvh7-bvhb2k">



























<link rel="alternate" type="application/rss+xml" href="/tutorial/rss.xml" title="Logto docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tutorial/atom.xml" title="Logto docs Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/terms/rss.xml" title="Logto docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/terms/atom.xml" title="Logto docs Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/about/rss.xml" title="Logto docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/about/atom.xml" title="Logto docs Atom Feed"><link rel="stylesheet" href="/assets/css/styles.60a00b31.css">
<script src="/assets/js/runtime~main.9809d581.js" defer="defer"></script>
<script src="/assets/js/main.2b9b85a4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_iNvn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://logto.io" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/logto.svg" alt="Silverhand Logo" class="themedComponent_ghWv themedComponent--light__HzB"><img src="/img/logto_dark.svg" alt="Silverhand Logo" class="themedComponent_ghWv themedComponent--dark_znsS"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Docs</a><a href="https://blog.logto.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Mjen"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/quick-starts/">Quick starts</a><a class="navbar__item navbar__link" href="/integrations/">Integrations</a><div class="navbar__item dropdown dropdown--hoverable"><a href="https://openapi.logto.io/" target="_blank" rel="noopener noreferrer" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">API</a><ul class="dropdown__menu"><li><a href="https://bump.sh/logto/doc/logto-experience-api" target="_blank" rel="noopener noreferrer" class="dropdown__link">Experience API</a></li><li><a href="https://bump.sh/logto/doc/logto-management-api" target="_blank" rel="noopener noreferrer" class="dropdown__link">Management API</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/logto-io/logto" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Mjen"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_tHnc colorModeToggle_lX8z"><button class="clean-btn toggleButton_M_ik toggleButtonDisabled__iBf" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_bm2R"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_z9nA"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_ToYe"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_W6mT"><div class="docsWrapper_vcCX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_x_R6" type="button"></button><div class="docRoot_j1Mi"><aside class="theme-doc-sidebar-container docSidebarContainer_pI1q"><div class="sidebarViewport_NPJc"><div class="sidebar_T27M"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_h5Tv"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">💁 Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/get-started/">⚡ Get started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/get-started/welcome/">🎉 Welcome to Logto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-section"><a href="#" class="menu__link">Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/concepts/sign-in-experience/">🎾 Sign-in experience</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/concepts/authn-vs-authz/">🆚 Authentication vs. authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-section"><a href="#" class="menu__link">Recipes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/integrate-logto/">🔗 Integrate Logto in your application</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/protect-your-api/">⚔️ Protect your API</a><button aria-label="Expand sidebar category &#x27;⚔️ Protect your API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/customize-sie/">🎨 Customize sign-in experience</a><button aria-label="Expand sidebar category &#x27;🎨 Customize sign-in experience&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/multi-factor-auth/">🛡️ Multi-factor authentication</a><button aria-label="Expand sidebar category &#x27;🛡️ Multi-factor authentication&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/configure-connectors/">🪛 Configure connectors</a><button aria-label="Expand sidebar category &#x27;🪛 Configure connectors&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/interact-with-management-api/">🚝 Interact with Management API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/manage-users/">🧑‍🚀 Manage users</a><button aria-label="Expand sidebar category &#x27;🧑‍🚀 Manage users&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/organizations/">🏢 Organizations (Multi-tenancy)</a><button aria-label="Expand sidebar category &#x27;🏢 Organizations (Multi-tenancy)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/single-sign-on/">☁️ Enterprise SSO (SAML &amp; OIDC)</a><button aria-label="Expand sidebar category &#x27;☁️ Enterprise SSO (SAML &amp; OIDC)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/user-profile/">👤 User profiles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/inspect-audit-logs/">📜 Inspect audit logs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/logto-as-idp/">🌐 Logto as an Identity Provider (IdP)</a><button aria-label="Expand sidebar category &#x27;🌐 Logto as an Identity Provider (IdP)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/protected-app/">🔐 Protected App</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/webhooks/">🪝 Webhooks</a><button aria-label="Expand sidebar category &#x27;🪝 Webhooks&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/rbac/">🔐 Role-based access control (RBAC)</a><button aria-label="Expand sidebar category &#x27;🔐 Role-based access control (RBAC)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/custom-domain/">🌍 Custom domain</a><button aria-label="Expand sidebar category &#x27;🌍 Custom domain&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/deployment/">🚀 Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/configure-storage-providers/">💾 File storage provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/recipes/custom-jwt/">🎫 Custom token claims</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/enable-central-cache/">🗄️ Enable central cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/migrations/">🔄 Migrate to Logto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/impersonation/">🎭 User impersonation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-section"><a href="#" class="menu__link">References</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/references/tenants/">🗂️ Tenants</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/references/openid-connect/">📄 OpenID Connect</a><button aria-label="Expand sidebar category &#x27;📄 OpenID Connect&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/references/using-cli/">🖥 Using Logto CLI</a><button aria-label="Expand sidebar category &#x27;🖥 Using Logto CLI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/references/applications/">📱 Applications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/references/connectors/">🔌 Connectors</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/references/core/">🧱 Core Service</a><button aria-label="Collapse sidebar category &#x27;🧱 Core Service&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/references/core/configuration/">Configuration</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/references/resources/">📁 API Resource</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/references/sdk-convention/">📃 SDK convention</a><button aria-label="Expand sidebar category &#x27;📃 SDK convention&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/references/users/">👨‍👩‍👧‍👦 Users</a><button aria-label="Expand sidebar category &#x27;👨‍👩‍👧‍👦 Users&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/references/translate-cli/">🤖 I18n translation with CLI</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/references/tunnel-cli/">🤖 Using Logto Tunnel CLI</a><button aria-label="Expand sidebar category &#x27;🤖 Using Logto Tunnel CLI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_s9XT"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VoQd"><div class="docItemContainer_otqq"><article><div class="tocCollapsible_yt95 theme-doc-toc-mobile tocMobile_tcaC"><button type="button" class="clean-btn tocCollapsibleButton__U7H">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>🎫 Custom token claims</h1></header>
<div class="availability_kRMk"><img alt="Cloud availability" src="https://img.shields.io/badge/Cloud-✓ available-4EA254"><img alt="OSS availability" src="https://img.shields.io/badge/OSS-since v1.16-4EA254"></div>
<h2 class="anchor anchorWithStickyNavbar_ffHw" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>Access tokens play a critical role in the authentication and authorization process, carrying the subject&#x27;s identity information and permissions between the client applications and the Logto server.</p>
<p>Token claims are the key-value pairs that provide information about an entity or the token itself. The claims may include user information, token expiration time, permissions, and other metadata that are relevant to the authentication and authorization process.</p>
<p>There are two forms of access tokens in Logto:</p>
<p>JSON Web Token (JWT) is a popular format that encodes claims in a way that is both secure and readable by clients. Common claims like <code>sub</code>, <code>iss</code>, <code>aud</code>, <code>exp</code>, <code>iat</code>, and <code>jti</code> are used in line with the OAuth 2.0 protocol (See <a href="https://datatracker.ietf.org/doc/html/rfc7519" target="_blank" rel="noopener noreferrer">RFC7519</a> for more details). JWT tokens allow clients to directly access claims without needing an additional validation step. In Logto, access tokens are issued in JWT format when a client requests authorization for a specific resource or organization.</p>
<p>On the other hand, opaque tokens are tokens that are not self-contained and require an additional validation step via the token introspection endpoint. Despite the non-transparent format, opaque tokens can also be used to carry claims securely between parties. Token claims are securely stored in the Logto server and accessed by the client applications via the token introspection endpoint. Access tokens are issued in opaque format when no specific resource or organization is included in the authorization request. These tokens are primarily used for accessing the OIDC <code>userinfo</code> endpoint and other general purposes.</p>
<p>In many cases, standard claims are not enough to meet the specific needs of your applications, whether you&#x27;re using JWT or opaque tokens. To address this, Logto provides the flexibility to customize the claims within access tokens. With this feature, you can include any additional information necessary for your business logic, all securely transmitted in the tokens and retrievable via introspection in the case of opaque tokens.</p>
<h2 class="anchor anchorWithStickyNavbar_ffHw" id="how-does-it-work">How does it work?<a href="#how-does-it-work" class="hash-link" aria-label="Direct link to How does it work?" title="Direct link to How does it work?">​</a></h2>
<p>Logto allows you to insert custom claims into the <code>access token</code> through a callback function <code>getCustomJwtClaims</code>. You may provide your implementation of the <code>getCustomJwtClaims</code> function to return an object of custom claims. The return value will be merged with the original token payload and signed to generate the final access token.</p>
<!-- -->
<div class="theme-admonition theme-admonition-note admonition_hgf1 alert alert--secondary"><div class="admonitionHeading_xwtK"><span class="admonitionIcon_YDER"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_wtkp"><p>Logto build-in token claims can NOT be overridden or modified. Custom claims will be added to the token as additional claims. If any custom claims conflict with the built-in claims, those custom claims will be ignored.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_ffHw" id="create-a-custom-token-claims-script">Create a custom token claims script<a href="#create-a-custom-token-claims-script" class="hash-link" aria-label="Direct link to Create a custom token claims script" title="Direct link to Create a custom token claims script">​</a></h2>
<p>To add custom claims to the access token, you need to provide a script that returns an object containing those claims. The script should be written as a javascript function that returns an object with the custom claims.</p>
<p>Visit the <strong>Logto Console</strong> and click on the <strong>Custom JWT</strong> navigation item in the left sidebar.</p>
<p><img decoding="async" loading="lazy" alt="Custom JWT landing" src="/assets/images/custom-jwt-landing-98c725fa96b64187f593a16ca3487656.webp" width="4320" height="2700" class="img_deJ3"></p>
<p>There are two different types of access tokens that you can customize the access token claims for:</p>
<ul>
<li><strong>User access token</strong>: The access token issued for the end users. E.g. for Web applications or mobile applications.</li>
<li><strong>Machine-to-Machine access token</strong>: The access token issued for the services or applications. E.g. for machine-to-machine applications.</li>
</ul>
<p>Different types of access tokens may have different token payload contexts. You may customize the token claims for each type of access token separately.</p>
<p>Pick any type of access token you want to customize the token claims for, and click on the <strong>Add custom claims</strong> button to create a new script.</p>
<h2 class="anchor anchorWithStickyNavbar_ffHw" id="implement-the-getcustomjwtclaims-function">Implement the <code>getCustomJwtClaims</code> function<a href="#implement-the-getcustomjwtclaims-function" class="hash-link" aria-label="Direct link to implement-the-getcustomjwtclaims-function" title="Direct link to implement-the-getcustomjwtclaims-function">​</a></h2>
<p>In the <code>Custom JWT</code> details page, you may find the script editor to write your custom token claims script.</p>
<p><img decoding="async" loading="lazy" alt="Custom JWT details" src="/assets/images/custom-jwt-details-91883a075d4d545429a1f28d54844693.webp" width="3146" height="1818" class="img_deJ3"></p>
<h3 class="anchor anchorWithStickyNavbar_ffHw" id="edit-the-script">Edit the script<a href="#edit-the-script" class="hash-link" aria-label="Direct link to Edit the script" title="Direct link to Edit the script">​</a></h3>
<p>Use the code editor on the left side to modify the script. A default function signature with an empty object return value is provided for you to start with. You may modify the function to return an object of your own custom claims.</p>
<p>This editor uses the javascript language server to provide basic syntax highlighting, code completion, and error checking. The input parameter are well typed and documented in jsDoc style. You may use the IntelliSense of the editor to access the properties of the input object correctly. You may find the detailed parameter definitions on the right side of the page.</p>
<div class="theme-admonition theme-admonition-info admonition_hgf1 alert alert--info"><div class="admonitionHeading_xwtK"><span class="admonitionIcon_YDER"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_wtkp"><p>This function will be exported as a module. Make sure remain the function name as <code>getCustomJwtClaims</code> so the module can export the function correctly.</p></div></div>
<div class="language-javascript codeBlockContainer_fOpS theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_yYvF"><pre tabindex="0" class="prism-code language-javascript codeBlock__UVT thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_CNGr"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">getCustomJwtClaims</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> token</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> context</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> environmentVariables </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_TpOl"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_HL9a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_wDs6"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_Y5ea"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_ffHw" id="input-parameters">Input parameters<a href="#input-parameters" class="hash-link" aria-label="Direct link to Input parameters" title="Direct link to Input parameters">​</a></h3>
<p>The <code>getCustomJwtClaims</code> function takes an object as the input parameter. The input object contains the following properties:</p>
<ul>
<li>
<p><strong>token</strong></p>
<p>The token payload object. This object contains original token claims and metadata that you may need to access in the script.</p>
<p>You may find the detailed type definition of the token payload object and user data object on the right side of the page. The IntelliSense of the editor will also help you access these properties of the input object correctly.</p>
<p><strong>User access token payload object:</strong></p>
<table><thead><tr><th>Property</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td><code>jti</code></td><td>The unique JWT id</td><td><code>string</code></td></tr><tr><td><code>aud</code></td><td>The audience of the token</td><td><code>string</code></td></tr><tr><td><code>scope</code></td><td>The scopes of the token</td><td><code>string</code></td></tr><tr><td><code>clientId</code></td><td>The client id of the token</td><td><code>string</code></td></tr><tr><td><code>accountId</code></td><td>The user id of the token</td><td><code>string</code></td></tr><tr><td><code>expiresWithSession</code></td><td>Whether the token will expire with the session</td><td><code>boolean</code></td></tr><tr><td><code>grantId</code></td><td>The current authentication grant id of the token</td><td><code>string</code></td></tr><tr><td><code>gty</code></td><td>The grant type of the token</td><td><code>string</code></td></tr><tr><td><code>kind</code></td><td>The token kind</td><td><code>AccessToken</code></td></tr></tbody></table>
<p><strong>Machine-to-machine access token payload object:</strong></p>
<table><thead><tr><th>Property</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td><code>jti</code></td><td>The unique JWT id</td><td><code>string</code></td></tr><tr><td><code>aud</code></td><td>The audience of the token</td><td><code>string</code></td></tr><tr><td><code>scope</code></td><td>The scopes of the token</td><td><code>string</code></td></tr><tr><td><code>clientId</code></td><td>The client id of the token</td><td><code>string</code></td></tr><tr><td><code>kind</code></td><td>The token kind</td><td><code>ClientCredentials</code></td></tr></tbody></table>
</li>
<li>
<p><strong>context</strong> (Only available for user access token)</p>
<p>The context object contains the user data and grant data that relevant to the current authorization process.</p>
<p><strong>User data object:</strong></p>
<p>For user access token, Logto provides additional user data context for you to access. The user data object contains all the user profile data and organization membership data you may need to set up the custom claims. Please check <a href="/docs/references/users/">Users</a> and <a href="/docs/recipes/organizations/">Organizations</a> for more details.</p>
<p><strong>Grant data object:</strong></p>
<p>For user access token granted by impersonation token exchange, Logto provides additional grant data context for you to access. The grant data object contains the custom context from the subject token. Please check <a href="/docs/recipes/impersonation/#customizing-jwt-claims">Impersonation</a> for more details.</p>
</li>
<li>
<p><strong>environmentVariables</strong></p>
<p>Use the <strong>Set environment variables</strong> section on the right to set up the environment variables for your script. You may use these variables to store sensitive information or configuration data that you don&#x27;t want to hardcode in the script. e.g. API keys, secrets, or URLs.</p>
<p>All the environment variables you set here will be available in the script. Use the <code>environmentVariables</code> object in the input parameter to access these variables.</p>
</li>
<li>
<p><strong>api</strong></p>
<p>The <code>api</code> object provides a set of utility functions that you may use in your script for additional access control over the token issuing process. The <code>api</code> object contains the following functions:</p>
<div class="language-javascript codeBlockContainer_fOpS theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_yYvF"><pre tabindex="0" class="prism-code language-javascript codeBlock__UVT thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_CNGr"><span class="token-line" style="color:#393A34"><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">denyAccess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><br></span></code></pre><div class="buttonGroup_TpOl"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_HL9a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_wDs6"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_Y5ea"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>api.denyAccess</code> function allows you to deny the token issuing process with a custom message. You may use this function to enforce additional access validation over the token issuing process.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_ffHw" id="fetch-external-data">Fetch external data<a href="#fetch-external-data" class="hash-link" aria-label="Direct link to Fetch external data" title="Direct link to Fetch external data">​</a></h3>
<p>You may use the node built-in <code>fetch</code> function to fetch external data in your script. The <code>fetch</code> function is a promise-based function that allows you to make HTTP requests to external APIs.</p>
<div class="language-javascript codeBlockContainer_fOpS theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_yYvF"><pre tabindex="0" class="prism-code language-javascript codeBlock__UVT thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_CNGr"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">getCustomJwtClaims</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> environmentVariables </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://api.example.com/data&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">headers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">Authorization</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">Bearer </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">environmentVariables</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation constant" style="color:#36acaa">API_KEY</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_TpOl"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_HL9a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_wDs6"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_Y5ea"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_hgf1 alert alert--secondary"><div class="admonitionHeading_xwtK"><span class="admonitionIcon_YDER"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_wtkp"><p>Be aware, any external data fetching may introduce latency to the token issuing process. Make sure the external API is reliable and fast enough to meet your requirements. Additionally:</p><ul>
<li>Handle the error and timeout properly in your script to avoid the token issuing process being blocked.</li>
<li>Use proper authorization headers to protect your external API from unauthorized access.</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_ffHw" id="test-the-script">Test the script<a href="#test-the-script" class="hash-link" aria-label="Direct link to Test the script" title="Direct link to Test the script">​</a></h3>
<p>Make sure to test your script before saving it. Click on the <code>Test context</code> tab on the right side of the page to modify the mock token payload and user data context for testing.</p>
<p>Click on the <code>Run test</code> on the right-top corner of the editor to run the script with the mock data. The output of the script will be displayed in the <code>Test Result</code> drawer.</p>
<p><img decoding="async" loading="lazy" alt="Test result" src="/assets/images/test-result-d68866ebb16ca80543570aa86796c6b2.webp" width="2682" height="1322" class="img_deJ3"></p>
<div class="theme-admonition theme-admonition-note admonition_hgf1 alert alert--secondary"><div class="admonitionHeading_xwtK"><span class="admonitionIcon_YDER"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_wtkp"><p>The test result is the output of the <code>getCustomJwtClaims</code> function with the mock data you set (&quot;extra token claims&quot; got after completing the step 3 in <a href="#how-does-it-work">the sequence diagram</a>). The real token payload and user data context will be different when the script is executed in the token issuing process.</p></div></div>
<p>Click on the <strong>Create</strong> button to save the script. The custom token claims script will be saved and applied to the access token issuing process.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/logto-io/docs/tree/master/docs/docs/recipes/custom-jwt/README.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_xa1W" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_w0Xe"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/recipes/configure-storage-providers/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">💾 File storage provider</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/recipes/enable-central-cache/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">🗄️ Enable central cache</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_RzuJ thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#how-does-it-work" class="table-of-contents__link toc-highlight">How does it work?</a></li><li><a href="#create-a-custom-token-claims-script" class="table-of-contents__link toc-highlight">Create a custom token claims script</a></li><li><a href="#implement-the-getcustomjwtclaims-function" class="table-of-contents__link toc-highlight">Implement the <code>getCustomJwtClaims</code> function</a><ul><li><a href="#edit-the-script" class="table-of-contents__link toc-highlight">Edit the script</a></li><li><a href="#input-parameters" class="table-of-contents__link toc-highlight">Input parameters</a></li><li><a href="#fetch-external-data" class="table-of-contents__link toc-highlight">Fetch external data</a></li><li><a href="#test-the-script" class="table-of-contents__link toc-highlight">Test the script</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer_TCBS"><div class="container_oxh8"><div class="logoRow_e6WH"><img src="/img/silverhand.svg" alt="Logo"></div><div class="footerRow_MwlS"><div class="copyRight_Do1v">Copyright © 2024 Silverhand Inc. Built with Docusaurus.</div><div class="links_lMuC"><a class="footer__link-item" href="/">Docs</a><a href="https://github.com/logto-io/logto" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a><a href="https://logto.io/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About Us</a><a href="mailto: contact@logto.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></div></div></div></footer></div>
</body>
</html>